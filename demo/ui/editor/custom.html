<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>富文本编辑器 - 前端实例</title>
<link href="../../css/template.css" rel="stylesheet" type="text/css"/>
<style type="text/css">
  body{font-family:"Courier New";font-size:20px;}
  div.m-cmp{width:600px;}
</style>
</head>
<body>
<div class="g-doc">
	<div class="g-hd">
        <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1>
        <h2 class="m-title">富文本编辑器</h2>
    </div>
    <div class="g-bd">
    	<div class="g-mn">
    		<div class="m-cnt">
    			<div id="box" class="box"></div>
    		</div>
    		<div id="xxyy"></div>
        </div>
        <div class="g-sd" id="side">
        	<form class="w-form" onsubmit="return false;" name="param">
    			<h2>PARAM</h2>
				<div>初始内容：<input class="w-txt w-txt-1" value="6月27日，财政部长谢旭人作国务院关于2011年中央决算的报告：2011年中央财政收入5.1万亿，赤字6500亿；中央行政单位行政经费899亿；国防支出5829亿元，公共安全支出1037亿元。另外，审计署称，中央部门不规范资金达43.94亿元，其中计生委等部门违规收费2亿元。" name="content"/></div>
				<div><input type="checkbox" id="focus" name="focus"/><label for="focus">是否聚焦</label></div>
				<div><input type="button" class="w-btn" name="update" value="更新"/></div>
        	</form>
			<form class="w-form" onsubmit="return false;" name="api">
    			<h2>API</h2>
				<div><input type="button" class="w-btn" name="show" value="显示控件"/></div>
				<div><input type="button" class="w-btn" name="hide" value="隐藏控件"/></div>
				<div><input type="button" class="w-btn" name="setcontent" value="设置内容"/></div>
				<div><input type="button" class="w-btn" name="getcontent" value="获取内容"/></div>
        	</form>
		</div>
    </div>
</div>
<div class="g-bd">
    <div class="m-foot">
    	如有任何问题，请联系：魏文庆(<a href="mailto:wqwei@corp.netease.com">wqwei@corp.netease.com</a>)
    </div>
</div>
<div class="g-ft">
    <div class="m-foot">
    	&nbsp;&copy;&nbsp;网易-杭研院-前端技术组
    </div>
</div>
<script>window.NEJ_CONF = {root:'../../../res/'};</script>
<script src="../../../src/define.js?pro=../../"></script>
<script>
	var f = function(){
		var _ = NEJ.P;
		var e = _('nej.e');
		var v = _('nej.v');
		var i = _('nej.ui');
		var u = _('nej.u');
		var tu = _('t.u');
		var ut = _('nej.ut');
		var paramForm, apiForm, cmp;
		/**
		 * 更新控件
		 */
		function update(){
			 i._$$CustomEditor._$recycle(cmp);
			 var _data = paramForm._$getData();
			 cmp = i._$$CustomEditor._$allocate({
					parent: 'box',
					clazz: 'm-cmp',
					//content: _data.content,
					focus: !!_data.focus[0]
				});
		}
		/**
		 * 显示控件
		 */
		function show(){
			cmp&&cmp._$show();
		}
		/**
		 * 设置内容
		 * @param {String} _content	内容
		 */
		function setContent(_content){
			cmp&&cmp._$setContent(_content);
		}
		/**
		 * 获取内容
		 */
		function getContent(){
		    e._$get('xxyy').innerHTML = cmp._$getContent();
		}
		/**
		 * 隐藏控件
		 */
		function hide(){
			//cmp&&cmp._$hide();
			// for test
			cmp.__editor.__copt.area._$execCommand(
			    'inserthtml','<img width="100" src="https://www.google.com.hk/images/srpr/chrome_ntp_white_logo2.png"/>'
			);
		}
		/**
		 * 页面初始化函数
		 */
		function init(){
			paramForm = tu.form._$getInstance('param');
			apiForm = tu.form._$getInstance('api');
			paramForm._$focus();
			v._$addEvent(paramForm._$get('update'), 'click', function(){
				update();
			});
			v._$addEvent(apiForm._$get('show'), 'click', function(){
				show();
			});
			v._$addEvent(apiForm._$get('hide'), 'click', function(){
				hide();
			});
			v._$addEvent(apiForm._$get('setcontent'), 'click', function(){
				setContent(window.prompt('请输入内容(可以输入富文本)：'));
			});
			v._$addEvent(apiForm._$get('getcontent'), 'click', function(){
				getContent();
			});
			update();
		}
		init();
	};
	define(['{lib}base/event.js', '{lib}ui/editor/custom.js', '{pro}js/extend.js', '{pro}js/form.js'], f);
</script>
</body>
</html>